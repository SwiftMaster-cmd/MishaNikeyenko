/* ==========================================================================
   DASHBOARD v3.2 MOBILE-FIRST THEME
   ========================================================================== *
   * Preserves v3 spacing & general look
   * Adds: Guest Info grouped UI styles, proposal caution, sales badge
   * Safe-area padding, non-repeating gradient background
   * Table overflow fixes + stack-to-card patterns
   * Hide edit forms by default; reveal via .is-editing or JS inline
   * Mobile-first responsive type & spacing tokens
   * Stores Performance Highlight (collapsed Stores summary mode)
   ========================================================================== */

/* --------------------------------------------------------------------------
   Design Tokens
   -------------------------------------------------------------------------- */
:root {
  --brand:            #1e90ff;
  --brand-hover:      #4aa8ff;
  --brand-focus-ring: rgba(30,144,255,.6);

  --success:          #00c853;
  --success-bg:       rgba(0,200,83,.15);
  --warning:          #ffb300;
  --warning-bg:       rgba(255,179,0,.15);
  --danger:           #ff5252;
  --danger-hover:     #ff1744;
  --danger-bg:        rgba(255,82,82,.15);
  --info:             #82caff;

  --bg-page-a:        #0f1117;
  --bg-page-b:        #1a1c24;
  --bg-card:          rgba(26,28,36,.75);
  --bg-card-solid:    #1b1d25;
  --bg-card-hover:    rgba(26,28,36,.95);

  --border-color:     rgba(255,255,255,.08);
  --border-strong:    rgba(255,255,255,.18);

  --text-hi:          #ffffff;
  --text-med:         #e2e8f0;
  --text-lo:          #a0aec0;
  --text-muted:       #718096;
  --text-invert:      #0f1117;

  --table-stripe:     rgba(255,255,255,.03);

  --radius-sm:        4px;
  --radius-md:        8px;
  --radius-lg:        16px;
  --radius-xl:        20px;

  /* Spacing (mobile-first fluid) */
  --space-2xs: clamp(2px, .25vw, 4px);
  --space-xs:  clamp(4px, .5vw, 8px);
  --space-sm:  clamp(8px, 1vw, 12px);
  --space-md:  clamp(16px, 2vw, 24px);
  --space-lg:  clamp(24px, 4vw, 40px);
  --space-xl:  clamp(32px, 6vw, 64px);

  /* Type scale */
  --fs-2xs: clamp(.7rem, 1.5vw, .75rem);
  --fs-xs:  clamp(.8rem, 1.8vw, .85rem);
  --fs-sm:  clamp(.9rem, 2vw, .95rem);
  --fs-md:  clamp(1rem, 2.5vw, 1.05rem);
  --fs-lg:  clamp(1.2rem, 3.5vw, 1.4rem);
  --fs-xl:  clamp(1.6rem, 5vw, 1.75rem);
  --fs-xxl: clamp(2rem, 7vw, 2.5rem);

  --z-header: 100;
  --z-modal:  1000;

  --dur-fast: .12s;
  --dur-med:  .25s;
  --dur-slow: .4s;
  --ease-out: cubic-bezier(.25,.8,.25,1);
  --ease-in:  cubic-bezier(.42,0,1,1);
  --ease-io:  cubic-bezier(.42,0,.58,1);

  --shadow-card:   0 4px 12px rgba(0,0,0,.6);
  --shadow-card-h: 0 8px 24px rgba(0,0,0,.8);
  --shadow-btn:    0 4px 14px rgba(30,144,255,.4);
  --shadow-btn-h:  0 6px 20px rgba(30,144,255,.6);
  --shadow-danger: 0 4px 14px rgba(255,82,82,.4);
  --shadow-success:0 4px 14px rgba(0,200,83,.4);
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce){
  :root { --dur-fast:0ms; --dur-med:0ms; --dur-slow:0ms; }
  *{transition:none!important;animation:none!important;}
}

/* ==========================================================================
   Base / Reset Extensions
   ========================================================================== */
*{box-sizing:border-box;margin:0;padding:0;}
html,body{
  height:100%;
  min-height:100%;
  background:linear-gradient(135deg,var(--bg-page-a) 0%,var(--bg-page-b) 100%) no-repeat fixed;
  background-size:cover;
  color:var(--text-med);
  -webkit-text-size-adjust:100%;
  text-size-adjust:100%;
  max-width:100%;
  overflow-x:hidden;
}
body{
  font-family:'Segoe UI','SF Pro',Arial,sans-serif;
  /* Safe-area + bottom pad */
  padding-top:calc(env(safe-area-inset-top,0px) + var(--space-sm));
  padding-bottom:calc(env(safe-area-inset-bottom,0px) + var(--space-xl));
  padding-left:5%;
  padding-right:5%;
  font-size:var(--fs-md);
  line-height:1.4;
}
img,svg,video,canvas{max-width:100%;height:auto;display:block;}
button{font-family:inherit;font-size:inherit;line-height:inherit;}
a{color:var(--brand);text-decoration:none;}
a:hover{text-decoration:underline;}

/* Scrollbars */
::-webkit-scrollbar{width:10px;height:10px;}
::-webkit-scrollbar-track{background:rgba(255,255,255,.05);}
::-webkit-scrollbar-thumb{background:rgba(255,255,255,.25);border-radius:5px;}
::-webkit-scrollbar-thumb:hover{background:rgba(255,255,255,.4);}

/* ==========================================================================
   Header
   ========================================================================== */
.admin-header{
  position:sticky;
  top:0;
  z-index:var(--z-header);
  display:flex;
  justify-content:space-between;
  align-items:center;
  width:100%;
  margin-left:auto;
  margin-right:auto;
  padding:var(--space-sm) 0;
  background:rgba(26,28,36,.65);
  backdrop-filter:saturate(180%) blur(12px);
  border-bottom:1px solid var(--border-color);
}
.admin-header h2{
  margin:0;
  font-size:var(--fs-xl);
  font-weight:700;
  color:var(--text-hi);
}
.admin-header button{
  padding:var(--space-xs) var(--space-md);
  border-radius:var(--radius-md);
  background:var(--brand);
  color:var(--text-hi);
  font-weight:600;
  border:none;
  cursor:pointer;
  box-shadow:var(--shadow-btn);
  transition:box-shadow var(--dur-med) var(--ease-out);
}
.admin-header button:hover{box-shadow:var(--shadow-btn-h);}

/* Logout */
#logoutBtn{
  background:rgba(255,255,255,.1);
  color:var(--text-hi);
  border:1px solid rgba(255,255,255,.3);
  padding:var(--space-xs) var(--space-md);
  font-size:var(--fs-sm);
  border-radius:var(--radius-md);
  cursor:pointer;
  transition:background var(--dur-med) var(--ease-out),transform var(--dur-fast) var(--ease-out);
}
#logoutBtn:hover{background:rgba(255,255,255,.2);transform:translateY(-1px);}

/* ==========================================================================
   Main Content Grid
   ========================================================================== */
#adminApp{
  width:100%;
  max-width:100%;
  margin:var(--space-lg) auto;
  padding:0;
  display:grid;
  grid-template-columns:1fr;
  gap:var(--space-lg);
}
@media (min-width:768px){
  #adminApp{max-width:90%;gap:var(--space-xl);}
}
@media (min-width:1200px){
  #adminApp{max-width:1200px;}
  /* opt-in for 2-col: uncomment if desired */
  /* #adminApp{grid-template-columns:1fr 1fr;} */
  /* #adminApp>.admin-section.section-span-2{grid-column:span 2;} */
}

/* ==========================================================================
   Section Card
   ========================================================================== */
.admin-section{
  position:relative;
  width:100%;
  background:var(--bg-card);
  border:1px solid var(--border-color);
  border-radius:var(--radius-xl);
  padding:clamp(16px,5vw,32px);
  box-shadow:var(--shadow-card);
  backdrop-filter:blur(12px) saturate(180%);
  transition:box-shadow var(--dur-med) var(--ease-out),background var(--dur-med) var(--ease-out);
}
.admin-section:hover{box-shadow:var(--shadow-card-h);background:var(--bg-card-hover);}
.admin-section h2,.section-title{
  font-size:var(--fs-lg);
  font-weight:700;
  color:var(--text-hi);
  margin-bottom:var(--space-md);
}

/* Collapsible (opt-in) */
.admin-section.collapsible>.section-header{
  display:flex;justify-content:space-between;align-items:center;cursor:pointer;user-select:none;
}
.admin-section.collapsible[data-open="false"]>*:not(.section-header){display:none;}

/* ==========================================================================
   Inputs
   ========================================================================== */
input,select,textarea{
  width:100%;
  border-radius:var(--radius-md);
  border:1px solid var(--border-color);
  padding:var(--space-xs) var(--space-sm);
  font-size:var(--fs-md);
  background:rgba(255,255,255,.06);
  color:var(--text-med);
  transition:border var(--dur-fast) var(--ease-out),background var(--dur-fast) var(--ease-out);
}
input:focus,select:focus,textarea:focus{
  outline:none;
  border-color:var(--brand);
  background:rgba(255,255,255,.1);
  box-shadow:0 0 0 2px var(--brand-focus-ring);
}

/* iOS zoom prevention: ensure tap targets >=16px */
@media (max-width:600px){
  input,select,textarea,button,.btn,.gfield{font-size:16px!important;line-height:1.2;}
}

/* ==========================================================================
   Buttons
   ========================================================================== */
button,.btn,.login-btn{
  border:none;
  border-radius:var(--radius-md);
  padding:var(--space-sm) var(--space-md);
  font-weight:600;
  cursor:pointer;
  line-height:1.2;
  transition:transform var(--dur-fast) var(--ease-out),box-shadow var(--dur-fast) var(--ease-out),background var(--dur-fast) var(--ease-out);
}
.btn-sm{padding:var(--space-xs) var(--space-sm);font-size:var(--fs-sm);}
.btn-lg{padding:var(--space-md) var(--space-lg);font-size:var(--fs-md);}

.btn-primary{background:var(--brand);color:var(--text-hi);box-shadow:var(--shadow-btn);}
.btn-primary:hover{background:var(--brand-hover);box-shadow:var(--shadow-btn-h);}

.btn-secondary{background:rgba(255,255,255,.15);color:var(--text-med);}
.btn-secondary:hover{background:rgba(255,255,255,.25);}

.btn-success{background:var(--success);color:var(--text-hi);box-shadow:var(--shadow-success);}
.btn-success:hover{filter:brightness(1.1);}

.btn-danger{background:var(--danger);color:var(--text-hi);box-shadow:var(--shadow-danger);}
.btn-danger:hover{background:var(--danger-hover);}

.btn-warning{background:var(--warning);color:#000;box-shadow:0 4px 14px rgba(255,179,0,.3);}
.btn-warning:hover{filter:brightness(1.05);}

.btn-ghost{background:transparent;color:var(--brand);}
.btn-ghost:hover{background:rgba(30,144,255,.15);}

/* Make button stacks friendly on small screens */
@media (max-width:480px){
  .btn-responsive,
  .user-card-actions button,
  .review-controls button,
  .guest-card .guest-edit-form button,
  .guest-forms-table td button,
  .store-add button,
  .guestinfo-controls button{
    width:100%;
    margin-top:var(--space-xs);
  }
  .guest-forms-table td button:first-child{margin-top:0;}
}

/* ==========================================================================
   Role Badges
   ========================================================================== */
.role-badge{
  display:inline-block;
  padding:2px 10px;
  font-size:var(--fs-xs);
  font-weight:600;
  border-radius:999px;
  line-height:1.2;
  box-shadow:0 0 0 1px var(--border-color) inset;
  vertical-align:middle;
  white-space:nowrap;
}
.role-admin{background:var(--brand);color:var(--text-hi);}
.role-dm{background:rgba(60,120,255,.8);color:#fff;}
.role-lead{background:rgba(30,200,120,.8);color:#fff;}
.role-me{background:rgba(180,180,200,.4);color:#fff;}
.role-guest{background:rgba(180,180,200,.5);color:var(--text-med);}

/* ==========================================================================
   Tables (Global)
   ========================================================================== */
.table-responsive-wrapper,
.guest-forms-table-wrap,
.store-table-wrap{
  width:100%;
  max-width:100%;
  overflow-x:auto;
  -webkit-overflow-scrolling:touch;
}

table{
  width:100%;
  border-collapse:collapse;
  font-size:var(--fs-sm);
}
th,td{
  padding:var(--space-sm);
  border-bottom:1px solid var(--border-color);
  text-align:left;
  white-space:nowrap;
}
th{color:var(--text-hi);font-weight:600;}
td{color:var(--text-med);}
tr:nth-child(odd){background:var(--table-stripe);}
td:last-child{text-align:right;}

/* Allow wrapping on narrow viewports */
@media (max-width:640px){
  th,td{white-space:normal;overflow-wrap:anywhere;word-break:break-word;}
}

/* Stackable tables (opt-in via .table-stackable) */
@media (max-width:600px){
  .table-stackable,
  .table-stackable thead,
  .table-stackable tbody,
  .table-stackable tr,
  .table-stackable th,
  .table-stackable td{
    display:block;
    width:100%;
  }
  .table-stackable thead{display:none;}
  .table-stackable tr{
    margin-bottom:var(--space-md);
    padding:var(--space-md);
    border:1px solid var(--border-color);
    border-radius:var(--radius-lg);
    background:var(--bg-card-hover);
    box-shadow:var(--shadow-card);
  }
  .table-stackable td{
    padding:var(--space-xs) 0;
    border:none;
    display:flex;
    justify-content:space-between;
    align-items:flex-start;
    gap:var(--space-sm);
  }
  .table-stackable td::before{
    content:attr(data-label);
    font-weight:600;
    color:var(--text-hi);
    flex:0 0 auto;
  }
  .table-stackable td:last-child{
    justify-content:flex-start;
    flex-wrap:wrap;
    margin-top:var(--space-xs);
    text-align:left;
  }
}

/* ==========================================================================
   Stores Section (FULL TABLE MODE)
   ========================================================================== */
.stores-section{margin-bottom:var(--space-lg);}
.store-add{
  display:flex;
  gap:var(--space-sm);
  align-items:flex-start;
  width:100%;
  margin-top:var(--space-sm);
}
.store-add input{flex:1;}
@media (max-width:600px){
  .store-add{flex-direction:column;}
  .store-add input,.store-add button{width:100%;}
}

/* Responsive readability tweaks */
.store-table{table-layout:auto;}
.store-table th,
.store-table td{white-space:nowrap;}
.store-table .store-tl-wrap{
  display:flex;
  flex-direction:column;
  align-items:flex-start;
  gap:var(--space-2xs);
  max-width:min(220px,100%);
  overflow-wrap:anywhere;
}
.store-table .store-sales-wrap{
  display:flex;
  align-items:center;
  gap:var(--space-xs);
  flex-wrap:wrap;
}
.metric-chip{
  display:inline-block;
  padding:0 var(--space-xs);
  font-size:var(--fs-xs);
  line-height:1.4;
  border-radius:var(--radius-sm);
  background:rgba(255,255,255,.1);
  color:var(--text-med);
  white-space:nowrap;
}
.metric-chip.success{background:var(--success-bg);color:var(--success);}
.metric-chip.warning{background:var(--warning-bg);color:var(--warning);}
.metric-chip.danger{background:var(--danger-bg);color:var(--danger);}

/* Small screens: stackable (requires .table-stackable on table) */
@media (max-width:600px){
  .store-table.table-stackable,
  .store-table.table-stackable thead,
  .store-table.table-stackable tbody,
  .store-table.table-stackable tr,
  .store-table.table-stackable th,
  .store-table.table-stackable td{
    display:block;
    width:100%;
  }
  .store-table.table-stackable thead{display:none;}
  .store-table.table-stackable tr{
    margin-bottom:var(--space-md);
    padding:var(--space-md);
    border:1px solid var(--border-color);
    border-radius:var(--radius-lg);
    background:var(--bg-card-hover);
    box-shadow:var(--shadow-card);
  }
  .store-table.table-stackable td{
    padding:var(--space-xs) 0;
    border:none;
    display:flex;
    justify-content:space-between;
    align-items:flex-start;
    gap:var(--space-sm);
    white-space:normal;
  }
  .store-table.table-stackable td::before{
    content:attr(data-label);
    font-weight:600;
    color:var(--text-hi);
    flex:0 0 auto;
  }
  .store-table.table-stackable td:last-child{
    justify-content:flex-start;
    flex-wrap:wrap;
    margin-top:var(--space-xs);
    text-align:left;
  }
}
@media (max-width:480px){
  .store-add{gap:var(--space-xs);}
}

/* ==========================================================================
   Users Section
   ========================================================================== */
.users-section .users-container{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(min(300px,100%),1fr));
  gap:var(--space-lg);
  width:100%;
}
.user-card{
  background:var(--bg-card);
  border:1px solid var(--border-color);
  border-radius:var(--radius-lg);
  padding:var(--space-lg);
  box-shadow:var(--shadow-card);
  transition:box-shadow var(--dur-med) var(--ease-out),background var(--dur-med) var(--ease-out);
  width:100%;
}
.user-card:hover{box-shadow:var(--shadow-card-h);background:var(--bg-card-hover);}
.user-card-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:var(--space-md);
  gap:var(--space-sm);
  flex-wrap:wrap;
}
.user-name{font-size:var(--fs-md);font-weight:700;color:var(--text-hi);}
.user-email{font-size:var(--fs-sm);color:var(--text-muted);overflow-wrap:anywhere;}
.user-card-info{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(140px,1fr));
  gap:var(--space-xs) var(--space-md);
  margin-bottom:var(--space-md);
  color:var(--text-med);
  font-size:var(--fs-sm);
}
.user-card-info b{color:var(--text-hi);}
.user-card-actions{
  display:grid;
  grid-template-columns:1fr auto;
  gap:var(--space-sm);
  align-items:start;
  width:100%;
}
@media (max-width:600px){
  .user-card-actions{grid-template-columns:1fr;width:100%;}
  .user-card-actions select,.user-card-actions button{width:100%;}
  .user-card-info{grid-template-columns:1fr;}
}

/* ==========================================================================
   Reviews Section
   ========================================================================== */
.reviews-section h2{margin-bottom:var(--space-md);}
.review-controls{
  display:flex;
  gap:var(--space-sm);
  margin-bottom:var(--space-md);
  flex-wrap:wrap;
  justify-content:flex-end;
  width:100%;
}
.reviews-container{
  display:grid;
  gap:var(--space-md);
  width:100%;
}
.review-card{
  background:var(--bg-card);
  border:1px solid var(--border-color);
  border-radius:var(--radius-lg);
  padding:var(--space-lg);
  box-shadow:var(--shadow-card);
  transition:box-shadow var(--dur-med) var(--ease-out),background var(--dur-med) var(--ease-out);
  width:100%;
}
.review-card:hover{box-shadow:var(--shadow-card-h);background:var(--bg-card-hover);}
.review-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:var(--space-sm);
  gap:var(--space-sm);
  flex-wrap:wrap;
  width:100%;
}
.review-header .left{
  display:flex;
  align-items:center;
  gap:var(--space-xs);
}
.review-star{font-size:1.2rem;color:gold;cursor:pointer;transition:transform var(--dur-fast) var(--ease-out);}
.review-star.inactive{color:rgba(255,255,255,.3);}
.review-star:hover{transform:scale(1.1);}
.review-header .info{font-size:var(--fs-sm);color:var(--text-med);}
.review-header .info b{color:var(--text-hi);}
.review-rating{margin-bottom:var(--space-sm);font-size:var(--fs-md);color:gold;}
.review-comment{font-size:var(--fs-md);line-height:1.5;color:var(--text-med);margin-bottom:var(--space-md);}
.review-meta{
  display:flex;
  flex-wrap:wrap;
  gap:var(--space-md);
  font-size:var(--fs-xs);
  color:var(--text-muted);
}
.review-meta b{color:var(--text-med);}
@media (max-width:600px){
  .review-header{flex-direction:column;align-items:flex-start;}
  .review-meta{flex-direction:column;gap:var(--space-xs);}
}

/* ==========================================================================
   Guest Form Submissions (Dashboard)
   ========================================================================== */
.guest-forms-section{margin-top:var(--space-sm);}
.guest-forms-section h2{margin-bottom:var(--space-md);}

.guest-forms-table-wrap{
  width:100%;
  max-width:100%;
  overflow-x:auto;
  -webkit-overflow-scrolling:touch;
}
.guest-forms-table{
  width:100%;
  border-collapse:collapse;
  font-size:var(--fs-sm);
}
.guest-forms-table th,
.guest-forms-table td{
  padding:var(--space-sm);
  color:var(--text-med);
  border-bottom:1px solid var(--border-color);
  text-align:left;
  vertical-align:middle;
  white-space:nowrap;
}
.guest-forms-table th{color:var(--text-hi);font-weight:600;}
.guest-forms-table td:last-child{text-align:right;}
.guest-forms-table td button{margin-left:var(--space-xs);}
.guest-forms-table tr.consumed td{opacity:.7;}
.guest-forms-table tr.linked td{background:var(--success-bg);}

@media (max-width:640px){
  .guest-forms-table.table-stackable,
  .guest-forms-table.table-stackable thead,
  .guest-forms-table.table-stackable tbody,
  .guest-forms-table.table-stackable tr,
  .guest-forms-table.table-stackable th,
  .guest-forms-table.table-stackable td{
    display:block;
    width:100%;
  }
  .guest-forms-table.table-stackable thead{display:none;}
  .guest-forms-table.table-stackable tr{
    margin-bottom:var(--space-md);
    padding:var(--space-md);
    border:1px solid var(--border-color);
    border-radius:var(--radius-lg);
    background:var(--bg-card-hover);
    box-shadow:var(--shadow-card);
  }
  .guest-forms-table.table-stackable td{
    padding:var(--space-xs) 0;
    border:none;
    white-space:normal;
    display:flex;
    justify-content:space-between;
    align-items:flex-start;
    gap:var(--space-sm);
  }
  .guest-forms-table.table-stackable td::before{
    content:attr(data-label);
    font-weight:600;
    color:var(--text-hi);
    flex:0 0 auto;
  }
  .guest-forms-table.table-stackable td:last-child{
    justify-content:flex-start;
    flex-wrap:wrap;
    margin-top:var(--space-xs);
  }
  .guest-forms-table.table-stackable td button{
    margin:0;
    padding:var(--space-xs) var(--space-sm);
    font-size:var(--fs-xs);
  }
}

/* ==========================================================================
   Guest Info (Dashboard) -- OVERHAUL
   ========================================================================== */

/* Top-level controls row (filters, proposals, sales) */
.guestinfo-controls{
  display:flex;
  flex-wrap:wrap;
  gap:var(--space-sm);
  margin-bottom:var(--space-md);
}
.guestinfo-controls span{
  line-height:1.5;
  font-size:var(--fs-xs);
  color:var(--text-muted);
}

/* Proposal alert (collapsed view when proposals hidden) */
.guestinfo-proposal-alert{
  margin:var(--space-sm) 0;
  padding:var(--space-sm);
  border:1px solid var(--warning);
  border-radius:var(--radius-md);
  background:var(--warning-bg);
  color:var(--warning);
  font-weight:600;
  text-align:center;
  line-height:1.35;
}

/* Sales badge if you want to inline counts elsewhere */
.guestinfo-sales-badge{
  display:inline-block;
  padding:0 var(--space-sm);
  font-size:var(--fs-xs);
  line-height:1.4;
  border-radius:999px;
  background:var(--success-bg);
  color:var(--success);
  font-weight:600;
}

/* Status subsections (New / Working / Proposal / Sale view) */
.guestinfo-subsection{
  margin-top:var(--space-md);
}
.guestinfo-subsection>h3{
  font-size:var(--fs-md);
  font-weight:700;
  color:var(--text-hi);
  margin-bottom:var(--space-sm);
  display:flex;
  align-items:center;
  gap:var(--space-xs);
}
.guestinfo-subsection-empty{
  opacity:.7;
}
.guestinfo-subsection-highlight{
  border:1px solid var(--warning);
  padding:var(--space-sm);
  border-radius:var(--radius-md);
  background:var(--warning-bg);
}
.guestinfo-empty-msg{
  font-size:.95em;
  opacity:.7;
  padding:var(--space-sm);
  text-align:center;
}

/* Guest card container grid (subsection body) */
.guestinfo-container{
  display:grid;
  grid-template-columns:1fr;
  gap:var(--space-md);
  width:100%;
}
@media (min-width:640px){
  .guestinfo-container{
    grid-template-columns:repeat(auto-fit,minmax(min(340px,100%),1fr));
  }
}

/* Guest card shell */
.guest-card{
  background:var(--bg-card);
  border:1px solid var(--border-color);
  border-radius:var(--radius-lg);
  padding:var(--space-lg);
  box-shadow:var(--shadow-card);
  transition:box-shadow var(--dur-med) var(--ease-out),background var(--dur-med) var(--ease-out);
  width:100%;
}
.guest-card:hover{box-shadow:var(--shadow-card-h);background:var(--bg-card-hover);}

/* Display rows */
.guest-card .guest-display>div{
  margin-bottom:var(--space-xs);
  font-size:var(--fs-sm);
  color:var(--text-med);
}
.guest-card .guest-display b{color:var(--text-hi);}
.guest-card .guest-sale-summary{
  margin-top:var(--space-xs);
  font-size:var(--fs-xs);
  color:var(--success);
}

/* Quick edit form (hidden by default; see .is-editing) */
.guest-edit-form{display:none;margin-top:var(--space-sm);padding-top:var(--space-sm);border-top:1px solid var(--border-color);font-size:var(--fs-sm);}
.guest-edit-form label{display:block;margin-bottom:var(--space-sm);}
.guest-edit-form input,
.guest-edit-form textarea{margin-top:var(--space-2xs);}
.guest-card.is-editing .guest-display{display:none;}
.guest-card.is-editing .guest-edit-form{display:block;}
.guest-card.is-editing{background:var(--bg-card-hover);box-shadow:var(--shadow-card-h);}

/* Action row */
.guest-card-actions{
  margin-top:var(--space-sm);
  display:flex;
  flex-wrap:wrap;
  gap:var(--space-xs);
}
@media (max-width:480px){
  .guest-card-actions .btn{width:100%;}
}

/* Optional grid field layout for denser displays */
.guest-card-fields {
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(160px,1fr));
  gap:var(--space-sm) var(--space-md);
  margin-bottom:var(--space-sm);
}
.guest-card-field-label {
  display:block;
  font-size:var(--fs-xs);
  color:var(--text-muted);
  margin-bottom:var(--space-2xs);
  line-height:1.2;
}
.guest-card-field-value {
  display:block;
  font-size:var(--fs-sm);
  color:var(--text-med);
  overflow-wrap:anywhere;
  line-height:1.35;
}
@media (max-width:480px){
  .guest-card-fields{grid-template-columns:1fr;}
}

/* Sale pill (used in lists if desired) */
.sale-pill {
  display:inline-block;
  padding:0 var(--space-sm);
  margin-top:var(--space-xs);
  font-size:var(--fs-xs);
  line-height:1.5;
  border-radius:999px;
  background:var(--success-bg);
  color:var(--success);
  white-space:nowrap;
}
.sale-pill b{color:var(--success);font-weight:700;}

/* ==========================================================================
   Congrats / All-Good card (DEPRECATED - leaving for possible reuse)
   ========================================================================== */
.allgood-congrats-section {
  text-align:center;
  background:linear-gradient(135deg,rgba(30,144,255,.25),rgba(0,200,83,.25));
  border:1px solid rgba(255,255,255,.25);
}
.allgood-header{
  display:flex;
  justify-content:center;
  align-items:center;
  position:relative;
  margin-bottom:var(--space-md);
}
.allgood-header h2{
  margin:0;
  font-size:var(--fs-lg);
  color:var(--text-hi);
}
.allgood-expand-btn{
  position:absolute;
  top:0;
  right:0;
  line-height:1;
  padding:0 var(--space-sm);
  font-size:var(--fs-md);
}
.allgood-metrics{
  display:flex;
  justify-content:center;
  gap:var(--space-lg);
  flex-wrap:wrap;
  margin-bottom:var(--space-md);
}
.agm{
  font-size:var(--fs-lg);
  font-weight:700;
  padding:var(--space-xs) var(--space-sm);
  border-radius:var(--radius-md);
  background:rgba(255,255,255,.1);
}
.agm-rating{color:var(--brand);}
.agm-staff{color:var(--success);}
.agm-budget{color:var(--warning);}
.allgood-cta-wrap{
  margin-top:var(--space-sm);
}
.allgood-collapse-fab{
  text-align:right;
  margin-bottom:var(--space-sm);
}

/* ==========================================================================
   Utilities
   ========================================================================== */
.text-center{text-align:center!important;}
.u-hide{display:none!important;}
.u-show-inline{display:inline-block!important;}
.mt-sm{margin-top:var(--space-sm)!important;}
.mt-md{margin-top:var(--space-md)!important;}
.mt-lg{margin-top:var(--space-lg)!important;}
.w-100{width:100%!important;}
.section-span-2{grid-column:span 2;}

/* --- Stores summary blocks (partial table mode / legacy collapsed rows) --- */
.stores-container {
  display: grid;
  gap: var(--space-sm);
  width: 100%;
}
.user-store-block {width:100%;}
.user-store-summary {
  display:grid;
  grid-template-columns:auto auto 1fr auto auto;
  align-items:center;
  gap:var(--space-xs);
  padding:var(--space-sm) var(--space-md);
  border:1px solid var(--border-color);
  border-radius:var(--radius-md);
  background:var(--bg-card);
  cursor:pointer;
  font-size:var(--fs-sm);
  line-height:1.2;
  transition:background var(--dur-fast) var(--ease-out),
             box-shadow var(--dur-fast) var(--ease-out);
}
.user-store-summary.open {
  background: var(--bg-card-hover);
  box-shadow: var(--shadow-card);
}
.user-store-summary.store-met { border-color: rgba(0,200,83,.5); }
.user-store-summary.store-under { border-color: rgba(255,179,0,.5); }
.user-store-summary.store-nogoal { opacity:.85; }
.user-store-summary .uss-caret { width:1em;text-align:center; }
.user-store-summary .uss-name { font-weight:600;color:var(--text-hi);white-space:nowrap; }
.user-store-summary .uss-role-mix { display:flex;gap:var(--space-2xs); }
.user-store-summary .uss-progress { justify-self:end;white-space:nowrap;font-size:var(--fs-xs);opacity:.85; }
.store-budget-input {
  width:4.5ch;
  font-size:var(--fs-xs);
  padding:0 2px;
  text-align:right;
}
/* role pills in store summary */
.store-pill {
  display:inline-block;
  padding:0 6px;
  font-size:var(--fs-2xs);
  line-height:1.2;
  border-radius:999px;
  white-space:nowrap;
  box-shadow:0 0 0 1px var(--border-color) inset;
}
.store-pill.lead { background:rgba(30,200,120,.8); color:#fff; }
.store-pill.me   { background:rgba(180,180,200,.4); color:#fff; }
/* expanded detail */
.user-store-detail {
  margin-top:var(--space-xs);
  overflow-x:auto;
  -webkit-overflow-scrolling:touch;
}
.user-store-block-unassigned .user-store-summary {cursor:default;}

/* ==========================================================================
   STORES PERFORMANCE HIGHLIGHTS  (collapsed Stores summary mode)
   ========================================================================== *
   Markup emitted when **all stores** meet staffing + budget + rating thresholds.
   Section wrapper: .stores-highlight-section (also has .admin-section)
   State classes on card: .sh-met | .sh-under | .sh-nogoal
   -------------------------------------------------------------------------- */
.stores-highlight-section {
  text-align:center;
  padding-top:var(--space-lg);
  padding-bottom:var(--space-xl);
  position:relative;
}
.stores-highlight-section > h2 {
  margin-bottom:var(--space-md);
  display:inline-block;
  position:relative;
}
/* grid */
.stores-hl-grid{
  width:100%;
  max-width:860px;
  margin:0 auto;
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(min(240px,100%),1fr));
  gap:var(--space-lg);
}
@media (max-width:480px){
  .stores-hl-grid{gap:var(--space-md);}
}
/* card */
.sh-card{
  position:relative;
  cursor:pointer;
  padding:var(--space-lg) var(--space-md) var(--space-xl);
  border-radius:var(--radius-xl);
  background:var(--bg-card);
  border:1px solid var(--border-strong);
  box-shadow:var(--shadow-card);
  transition:transform var(--dur-fast) var(--ease-out),
             box-shadow var(--dur-fast) var(--ease-out),
             background var(--dur-fast) var(--ease-out);
}
.sh-card:hover,
.sh-card:focus-visible{
  transform:translateY(-2px) scale(1.01);
  box-shadow:var(--shadow-card-h);
  background:var(--bg-card-hover);
  outline:none;
}
.sh-card:active{transform:translateY(0) scale(.97);}
/* focus-visible ring for keyboard nav */
.sh-card:focus-visible{
  box-shadow:0 0 0 2px var(--brand-focus-ring),var(--shadow-card-h);
}
/* state color accents (thin top bar) */
.sh-card::before{
  content:"";
  position:absolute;
  top:0;left:0;right:0;
  height:4px;
  border-top-left-radius:inherit;
  border-top-right-radius:inherit;
  background:transparent;
}
.sh-card.sh-met::before   {background:var(--success);}
.sh-card.sh-under::before {background:var(--warning);}
.sh-card.sh-nogoal::before{background:var(--text-muted);}
/* header row (store # + staff mix) */
.sh-card-head{
  display:flex;
  justify-content:center;
  align-items:center;
  gap:var(--space-sm);
  margin-bottom:var(--space-sm);
  flex-wrap:wrap;
}
.sh-store-num{
  font-size:var(--fs-lg);
  font-weight:700;
  color:var(--text-hi);
  line-height:1;
}
.sh-staff-pills{
  display:inline-flex;
  gap:var(--space-xs);
  align-items:center;
}
.sh-pill{
  display:inline-block;
  padding:2px 8px;
  font-size:var(--fs-xs);
  font-weight:700;
  border-radius:999px;
  line-height:1.2;
  white-space:nowrap;
  box-shadow:0 0 0 1px var(--border-color) inset;
}
.sh-pill-lead{background:rgba(30,200,120,.85);color:#fff;}
.sh-pill-me{background:rgba(180,180,200,.6);color:#fff;}
.sh-pill-dm{background:rgba(60,120,255,.85);color:#fff;} /* optional */
/* rating row */
.sh-rating-row{
  display:flex;
  justify-content:center;
  align-items:baseline;
  gap:var(--space-xs);
  margin-bottom:var(--space-sm);
}
.sh-stars{
  font-size:clamp(1.25rem,4vw,1.75rem);
  line-height:1;
  color:gold;
  letter-spacing:1px;
}
.sh-rating-val{
  font-size:var(--fs-sm);
  color:var(--text-med);
}
/* progress */
.sh-progress-wrap{
  width:100%;
  max-width:220px;
  margin:0 auto var(--space-md);
}
.sh-progress-bar{
  width:100%;
  height:8px;
  background:rgba(255,255,255,.08);
  border-radius:999px;
  overflow:hidden;
  position:relative;
}
.sh-progress-fill{
  position:absolute;
  top:0;left:0;
  height:100%;
  width:var(--sh-pct,0%);
  background:var(--brand);
  transition:width var(--dur-med) var(--ease-out);
}
.sh-card.sh-met   .sh-progress-fill{background:var(--success);}
.sh-card.sh-under .sh-progress-fill{background:var(--warning);}
.sh-card.sh-nogoal .sh-progress-fill{background:var(--text-muted);}
.sh-progress-label{
  margin-top:var(--space-xs);
  font-size:var(--fs-xs);
  color:var(--text-muted);
  line-height:1.2;
}
/* CTA */
.sh-card-cta{
  margin-top:var(--space-xs);
  font-size:var(--fs-sm);
  font-weight:600;
  color:var(--brand);
  text-decoration:underline;
  text-underline-offset:2px;
  pointer-events:none; /* card handles click */
}
.sh-card:hover .sh-card-cta{color:var(--brand-hover);}
/* empty / all-good message */
.stores-highlight-empty{
  margin-top:var(--space-md);
  font-size:var(--fs-md);
  color:var(--text-muted);
}
.stores-highlight-empty strong{color:var(--text-hi);}
/* close button variant (if you place an X in header) */
.stores-highlight-section .sh-close-btn{
  position:absolute;
  top:var(--space-sm);
  right:var(--space-sm);
  z-index:1;
  background:transparent;
  color:var(--text-med);
  border:none;
  padding:var(--space-xs);
  line-height:1;
  cursor:pointer;
}
.stores-highlight-section .sh-close-btn:hover{color:var(--text-hi);}
/* reduced motion */
@media (prefers-reduced-motion:reduce){
  .sh-card{transition:none;}
  .sh-progress-fill{transition:none;}
}

/* ================================================================
   PERFORMANCE HIGHLIGHTS ROW (Ratings / Staffing / Budget buttons)
   ----------------------------------------------------------------
   Usage markup example:

   <div class="perf-hl-row">
     <button type="button" class="perf-hl-btn good" onclick="...">
       <span class="ph-icon">⭐</span>
       <span class="ph-label">Ratings</span>
       <span class="ph-val">4.8 avg</span>
     </button>
     <button type="button" class="perf-hl-btn good" onclick="...">
       <span class="ph-icon">👥</span>
       <span class="ph-label">Staffing</span>
       <span class="ph-val">2 / 2</span>
     </button>
     <button type="button" class="perf-hl-btn good" onclick="...">
       <span class="ph-icon">📈</span>
       <span class="ph-label">Budget</span>
       <span class="ph-val">105%</span>
     </button>
   </div>

   State classes: .good  .warn  .bad  (color accents)
   ---------------------------------------------------------------- */
.perf-hl-row{
  display:flex;
  justify-content:center;
  align-items:stretch;
  gap:var(--space-sm);
  margin:var(--space-md) auto;
  width:100%;
  max-width:640px;
  flex-wrap:wrap; /* wrap on small screens */
}

.perf-hl-btn{
  flex:1 1 160px;
  min-width:140px;
  max-width:220px;
  padding:var(--space-md) var(--space-sm);
  border-radius:var(--radius-lg);
  border:1px solid var(--border-color);
  background:var(--bg-card);
  box-shadow:var(--shadow-card);
  text-align:center;
  cursor:pointer;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  gap:var(--space-xs);
  line-height:1.2;
  font-size:var(--fs-sm);
  color:var(--text-med);
  transition:
    transform var(--dur-fast) var(--ease-out),
    box-shadow var(--dur-fast) var(--ease-out),
    background var(--dur-fast) var(--ease-out),
    border-color var(--dur-fast) var(--ease-out);
}

.perf-hl-btn:hover,
.perf-hl-btn:focus-visible{
  transform:translateY(-2px) scale(1.01);
  background:var(--bg-card-hover);
  box-shadow:var(--shadow-card-h);
  outline:none;
}

.perf-hl-btn:active{
  transform:translateY(0) scale(.97);
}

/* focus ring */
.perf-hl-btn:focus-visible{
  box-shadow:0 0 0 2px var(--brand-focus-ring),var(--shadow-card-h);
}

/* icon */
.perf-hl-btn .ph-icon{
  font-size:clamp(1.5rem,5vw,2rem);
  line-height:1;
}

/* label */
.perf-hl-btn .ph-label{
  font-size:var(--fs-xs);
  font-weight:700;
  text-transform:uppercase;
  letter-spacing:.5px;
  color:var(--text-hi);
}

/* value */
.perf-hl-btn .ph-val{
  font-size:var(--fs-md);
  font-weight:700;
  color:inherit; /* state colors below */
}

/* states ---------------------------------------------------------- */
.perf-hl-btn.good{
  border-color:var(--success);
  color:var(--success);
}
.perf-hl-btn.good .ph-label{color:var(--success);}

.perf-hl-btn.warn{
  border-color:var(--warning);
  color:var(--warning);
}
.perf-hl-btn.warn .ph-label{color:var(--warning);}

.perf-hl-btn.bad{
  border-color:var(--danger);
  color:var(--danger);
}
.perf-hl-btn.bad .ph-label{color:var(--danger);}

/* subtle background tint per state (on hover we already brighten) */
.perf-hl-btn.good{background:rgba(0,200,83,.08);}
.perf-hl-btn.warn{background:rgba(255,179,0,.08);}
.perf-hl-btn.bad{background:rgba(255,82,82,.08);}

.perf-hl-btn.good:hover,
.perf-hl-btn.good:focus-visible{background:rgba(0,200,83,.18);}
.perf-hl-btn.warn:hover,
.perf-hl-btn.warn:focus-visible{background:rgba(255,179,0,.18);}
.perf-hl-btn.bad:hover,
.perf-hl-btn.bad:focus-visible{background:rgba(255,82,82,.18);}